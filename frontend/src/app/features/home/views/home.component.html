<div
  class="h-[calc(100vh-3.5rem)] flex items-center justify-center text-center bg-linear-to-b from-slate-800 to-slate-900 overflow-auto"
>
  @if (isLoading()) {
    <div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm">
      <div class="flex flex-col items-center gap-3">
        <svg
          class="animate-spin h-12 w-12 text-sky-400"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
          ></path>
        </svg>
        <span class="text-sm font-medium text-slate-300">Loadingâ€¦</span>
      </div>
    </div>
  }
  <div class="bg-transparent h-[calc(100%-5rem)] w-full py-3 px-6 flex flex-col overflow-hidden">
    <app-search-bar></app-search-bar>

    <div class="mt-12 mb-10">
      <h1
        class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold tracking-tight leading-tight"
      >
        <span
          class="bg-linear-to-r from-sky-400 via-cyan-300 to-sky-500 bg-clip-text text-transparent drop-shadow-[0_4px_16px_rgba(14,165,233,0.3)]"
        >
          Find your fan community for your next away game
        </span>
      </h1>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 w-full auto-rows-max">
      <div class="flex flex-col gap-4">
        <div class="flex items-baseline gap-2">
          <h2 class="text-xl font-semibold text-slate-100">Featured Events</h2>
          <span class="text-xs font-medium text-sky-400/60">TRENDING</span>
        </div>
        <div
          class="relative w-full h-full p-12 flex items-center justify-center overflow-hidden rounded-2xl bg-slate-900 border border-slate-700 backdrop-blur-md ring-1 ring-slate-600/30 shadow-2xl shadow-slate-900/50"
        >
          @if (featuredEvents().length > 0) {
            <div class="absolute left-0 z-0 opacity-35 scale-75 -translate-x-6 pointer-events-none">
              @if (featuredEvents().length > 1) {
                <app-event-tile
                  [event]="
                    featuredEvents()[
                      (currentEventIndex() - 1 + featuredEvents().length) % featuredEvents().length
                    ]
                  "
                  class="text-xs"
                ></app-event-tile>
              }
            </div>

            <div class="z-10 transition-all duration-700 ease-out">
              <app-event-tile
                [event]="featuredEvents()[currentEventIndex()]"
                class="text-sm"
              ></app-event-tile>
            </div>

            <div class="absolute right-0 z-0 opacity-35 scale-75 translate-x-6 pointer-events-none">
              @if (featuredEvents().length > 1) {
                <app-event-tile
                  [event]="featuredEvents()[(currentEventIndex() + 1) % featuredEvents().length]"
                  class="text-xs"
                ></app-event-tile>
              }
            </div>
          }
        </div>
      </div>

      <div class="flex flex-col gap-4">
        <div class="flex items-baseline gap-2">
          <h2 class="text-xl font-semibold text-slate-100">Events Near You</h2>
          <span class="text-xs font-medium text-sky-400/60">LOCATION</span>
        </div>
        @if (userLocation()) {
          <div
            class="rounded-2xl overflow-hidden bg-slate-900 border border-slate-700 backdrop-blur-md ring-1 ring-slate-600/30 shadow-2xl shadow-slate-900/50 h-full p-2"
          >
            <app-map
              [center]="userLocation()!"
              [zoom]="12"
              [events]="nearbyEvents()"
              [height]="'100%'"
              [showUserMarker]="true"
              [fitBoundsToMarkers]="false"
            />
          </div>
        } @else {
          <div
            class="w-full h-85 rounded-2xl ring-1 ring-slate-600/30 bg-linear-to-br from-slate-700/20 to-slate-800/20 backdrop-blur-md flex items-center justify-center text-slate-400 shadow-2xl shadow-slate-900/50"
          >
            <div class="flex flex-col items-center gap-2">
              <svg class="w-8 h-8 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                ></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                ></path>
              </svg>
              <span class="text-sm">Unable to load map</span>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
